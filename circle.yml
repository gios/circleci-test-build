machine:
  node:
    version: 8.1.2

dependencies:
  pre:
    - cd ui && npm i
    - cd ui && ./node_modules/.bin/ng build
  post:
    - mkdir static
    - mv -v ui/dist/* static
    - git checkout -b heroku
    - sudo rsync -av * $CIRCLE_ARTIFACTS --exclude=mom-and-i --exclude=ui

deployment:
  staging:
    branch: heroku
    heroku:
      appname: mom-and-i